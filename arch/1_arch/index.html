<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>Duy Phuc  Pham | New version of mobile malware Catelites possibly linked to Cron cyber gang</title>
<meta name="description" content="Dr. Pham Duy Phuc webpage
">

<!-- Open Graph -->


<!-- Bootstrap & MDB -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" />

<!-- Fonts & Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

<!-- Code Syntax Highlighting -->
<link rel="stylesheet" href="https://gitcdn.link/repo/jwarby/jekyll-pygments-themes/master/github.css" />

<!-- Styles -->
<link rel="shortcut icon" href="/assets/img/favicon.ico">
<link rel="stylesheet" href="/assets/css/main.css">

<link rel="canonical" href="/arch/1_arch/">

<!-- Theming-->



  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-25Z3QPHEXC"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-25Z3QPHEXC');
  </script>


    
<!-- MathJax -->
<script type="text/javascript">
  window.MathJax = {
    tex: {
      tags: 'ams'
    }
  };
</script>
<script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-mml-chtml.js"></script>
<script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>


  </head>

  <body class="fixed-top-nav ">

    <!-- Header -->

    <header>

    <!-- Nav Bar -->
    <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
    <div class="container">
      
      <a class="navbar-brand title font-weight-lighter" href="https://phuc.fr/">
       <span class="font-weight-bold">Duy Phuc</span>   Pham
      </a>
      
      <!-- Navbar Toogle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>
      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/">
              about
              
            </a>
          </li>
          
          <!-- Other pages -->
          
          
          
          
          
          
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/projects/">
                projects
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/publications/">
                publications
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/talks/">
                talks
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/teaching/">
                teaching
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/arch/">
                virus-archives
                
              </a>
          </li>
          
          
          
        </ul>
      </div>
    </div>
  </nav>

</header>


    <!-- Content -->

    <div class="container mt-5">
      <div class="post">

  <header class="post-header">
    <h1 class="post-title">New version of mobile malware Catelites possibly linked to Cron cyber gang</h1>
    <p class="post-description">20 DEC 2017</p>
  </header>

  <article>
    <p>New malware targets accounts at over 2,200 financial institutions</p>

<p>Co-authored with <a href="https://twitter.com/virqdroid">Nikolaos Chrysaidos</a>, Head of Mobile Threats &amp; Security, Avast</p>

<p>In May 2017, <a href="https://thehackernews.com/2017/05/cron-mobile-banking-malware.html">Russian authorities arrested twenty members of a cybercriminal gang</a> who had been using a banking Trojan called “CronBot” to steal over $900,000. The gang hid the Trojan within a host of phony apps, some designed to look like authentic online banking apps, some designed to look like pornography apps. These thieves knew their target demographic: over one million unsuspecting users installed the malware onto their Android mobile devices. The good news is that the villainous gang has been apprehended. The bad news is that the villainous malware is still at large.</p>

<p>Now, we have uncovered and analyzed a new version of the malware, dubbed Catelites Bot, which shares similarities with the malware used for CronBot. While we have no hard evidence that the Catelites actor is linked to Cron, it is likely that Cron members have used the Catalites malware in their campaigns based on what we’ve seen so far. In the past few months, we have seen one or two fake apps per week attacking Android devices to make unsuspecting victims download the malware. Once downloaded, the criminals use <a href="https://www.avast.com/c-social-engineering">very sophisticated social engineering tricks</a> to get credit card information and possibly the ability to get into the victim’s bank account.</p>

<h2 id="how-does-it-get-on-your-device">How does it get on your device?</h2>
<hr />

<p>While we are still investigating the details of this malware, here is what we know: this malware gets “dropped” onto your device after you download an app from a third-party app store (not official shops like Google Play) or from malicious adware (malvertisements) or phishing sites. Once dropped onto your Android device, the malicious app looks like the icon seen in the screen below and is titled “System Application.”
<img src="/assets/img/arch/Catelites.assets/catelites-1.png" alt="catelites-1.png" /></p>

<h2 id="how-does-it-trick-you">How does it trick you?</h2>
<hr />

<p>When you click the malicious “System Application” app icon, it will ask you for admin rights. If you grant those permissions, the malware begins its work. The icon for the (fake) app you downloaded disappears and then, three familiar-looking, trusted app icons get dropped onto your home screen: one for Gmail, one for Google Play, and one for Chrome.</p>

<p><img src="/assets/img/arch/Catelites.assets/catelites-3-app-icons.png" alt="catelites-3-app-icons.png" /></p>

<p><em>The 3 new icons appear on your home screen for Gmail, Google Play and Chrome.</em></p>

<p>The malware author uses two sophisticated “social engineering” techniques to encourage you to open one of these three apps in order to display a fake overlay that invites you to enter sensitive information like your credit card. Cybercriminals are counting on the fact that you easily input credit card info for respected companies that you likely buy from regularly.  Specifically, these techniques are:</p>

<ul>
  <li>Creating mirror icons of three well-known apps: <em>Gmail, Google Play and Chrome</em></li>
  <li>Creating a notification that cannot be removed that links you to a fake “sign-in” to your account</li>
</ul>

<p>By placing these apps on the home screen, the user is more likely to open them, activating the malware so that the criminal can steal sensitive information.</p>

<p>_<img src="/assets/img/arch/Catelites.assets/Catelites-bank-overlay-4.png" alt="Catelites-bank-overlay-4.png" /><br />
_</p>

<p><em>First you click “Google Play Store” notification;<br />
then it asks for your credit card number.</em></p>

<h2 id="targeting-over-2200-financial-institutions">Targeting over 2,200 financial institutions</h2>
<hr />

<p>Worse still, this piece of malware can also go after your bank account login details. This malware has the ability to pose as over 2,200 banks and financial institutions. It does so by adopting the logo and mobile application name of a bank used in the Google Play Store, allowing the author to use simple templates to harvest username and password or credit card information. The overlay is HTML-based and not as sophisticated as other Android banking malware such as LokiBot, Red Alert, or Exobot, but the power here is clearly in the shotgun approach: using simple phishing overlay screens, the criminals are able to target many more users, increasing their likelihood of financial gain.</p>

<p><img src="/assets/img/arch/Catelites.assets/catelites-all-bank-apps-5.jpg" alt="catelites-all-bank-apps-5.jpg" /></p>

<p><em>Above shows examples of the fake overlay screens<br />
that pull in the logos of actual banks.</em></p>

<p>Once you open your own banking app, the malware activates and places a fake overlay on your actual banking app, tricking you into entering your bank login details and also your credit card info. Once you provide this, they have access to your account and credit card.</p>

<p><img src="/assets/img/arch/Catelites.assets/catelites-6-sample-flow-blur.png" alt="catelites-6-sample-flow-blur.png" /></p>

<p><em>If your bank is one of the 2,200 targeted financial institutions, the app pulls in the logo of your bank to make the overlay look official.</em></p>

<p>Catelites Bot - Airbank example</p>

<p>Furthermore, it appears to have a host of other functions built in, though not yet activated. These include intercepting all incoming and outgoing SMS messages, setting ringer and stream volume to mute, and retrieving all running tasks from other apps. In addition, it can persistently ask for specific admin rights that could wipe data from your device or even lock you out completely.</p>

<h2 id="technical-information">Technical Information</h2>
<p>=====================</p>

<ul>
  <li>Intercepts all incoming and outgoing SMS messages</li>
  <li>Retrieves running tasks, phone number, IMSI, device model, android version, installed applications</li>
  <li>Sets ringer and stream volume to mute so the user doesn’t hear sms notifications</li>
  <li>Hides main application icon from launcher to stay stealthy</li>
  <li>
    <p>Asks for device admin privileges in order to become persistent and get functions like:</p>
  </li>
  <li>Wipe Data</li>
  <li>Lock the device</li>
  <li>
    <p>Force a new unlock password for the device</p>
  </li>
  <li>Queries phone numbers from contacts</li>
  <li>Get SMS and MMS message conversations</li>
</ul>

<p><strong>Sets ringer and stream volume to mute in order to suppress sms notifications:</strong></p>

<p><img src="/assets/img/arch/Catelites.assets/catelites-ringer-7.png" alt="catelites-ringer-7.png" /></p>

<p><strong>Admin privileges</strong></p>

<p>Asks for device admin privileges in order to become persistent and get functions like Wipe Data, lock the device and force a new unlock password for the device:</p>

<p><strong><img src="/assets/img/arch/Catelites.assets/catelites-admin-privelages.png" alt="catelites-admin-privelages.png" /></strong></p>

<p><strong>Queries phone numbers from contacts:</strong></p>

<p><img src="/assets/img/arch/Catelites.assets/catelites-phone-numbers.png" alt="catelites-phone-numbers.png" /></p>

<p>The Trojan has code to encrypt a big batch of file extensions with AES. The encrypted files will usually be renamed with the original name and a different extension “.cat”.</p>

<p><img src="/assets/img/arch/Catelites.assets/catelites-last code.png" alt="catelites-last code.png" /></p>

<p>On December 8th 2017 a single botnet (C&amp;C: 195.54.163.91) obtained 8553 bots in less than a month as shown in the panel of the C&amp;C server.</p>

<p>The panel picture also shows similarities with the panel from the research that GroupIB did together with law enforcement to take down the “Cron” crew. We have no hard evidence linking Catelites actor llyamov to Cron but it is likely that Cron members have used the Catelites malware in their campaigns based on the exact Panel and bot similarities. The screenshot of the panel below also shows how easy it is to adjust the general overlay HTML (inject).</p>

<p><img src="/assets/img/arch/Catelites.assets/Catelites-Panel-8.png" alt="Catelites-Panel-8.png" /></p>

<h2 id="iocs"><strong>IOCs</strong></h2>
<hr />

<p><strong>SHA-256</strong></p>

<p><strong>Package Name</strong></p>

<p>0e741a21228f4f7ffdbb891524f3a246b60bee287965a74fe15009127f6de280</p>

<p>net.feeteyemountain.houseracerlangtree</p>

<p>14c7e547cb8dc8f5d629725fdbdd2e8c33693dd407b2f36cd03c613e59af2cc7</p>

<p>net.friendsuperanswerland.foodfootmonth</p>

<p>efe6d86d7482fbcb5b1e7e12e22c2b086e4ec988939ebdffc9d363413e5a3326</p>

<p>net.windclockmailsentence.doorpageperson</p>

<p>bf6a4b8c24cd4cf233137dcee735bc33849d34e659ec2fa5e0fa9b425fee9b4e</p>

<p>net.bodywooddoodle.mountainfriendeast</p>

<p>e174dd174c5e21daa86064562aaf274d3f6fe84f4a3970beed48c02c3b605d58</p>

<p>net.songtablepicture.nightrocksciencemen</p>

<p>b81e0b6fe123b8d4cf7d99c20de1c694360d146bf80d9490b1b0325a00bf7f5a</p>

<p>net.manmothersouth.manbooksoundangry</p>

<p>0c50311ee3e30fe5be1b863db1b60b32bc9afa8d4264b852a836220751c7e3b2</p>

<p>net.herfarmsunhead.angryspacefile</p>

<p>d8452b39b1962239e9dbe12e8a9d8d0ee098b9c8de8a8d55b5a95b67b552102f</p>

<p>net.homeclasswindwater.daymaildayeye</p>

<p>53dc796e2e77689b115701a92ad2bdaeb0c7a4e87bc9e9a0bbeda057b77e22ee</p>

<p>net.productmotherfire.sentencerockdeveloper</p>

  </article>

</div>

    </div>

    <!-- Footer -->

    
<footer class="fixed-bottom">
  <div class="container mt-0">
    &copy; Copyright 2024 Duy Phuc  Pham.
    Powered by <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank">Unsplash</a>.

    
  </div>
</footer>



  </body>

  <!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>

  <!-- Bootsrap & MDB scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.4.4/umd/popper.min.js" integrity="sha512-eUQ9hGdLjBjY3F41CScH3UX+4JDSI9zXeroz7hJ+RteoCaY+GP/LDoM8AO+Pt+DRFw3nXqsjh9Zsts8hnYv8/A==" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js" integrity="sha512-Mug9KHKmroQFMLm93zGrjhibM2z2Obg9l6qFG2qKjXEXkMp/VDkI4uju9m4QKPjWSwQ6O2qzZEnJDEeCw0Blcw==" crossorigin="anonymous"></script>

  
<!-- Mansory & imagesLoaded -->
<script defer src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
<script defer src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
<script defer src="/assets/js/mansory.js" type="text/javascript"></script>


  
<!-- Enable Tooltips -->
<script type="text/javascript">
$(function () {$('[data-toggle="tooltip"]').tooltip()})
</script>



<!-- Load Common JS -->
<script src="/assets/js/common.js"></script>

<!-- Load DarkMode JS -->
<script src="/assets/js/dark_mode.js"></script>


</html>
